---
title: "r-project"
author: "Riley Maher, Griffin Rubin, Katie Summers, Natalie Vadasz"
date: "Dec 8, 2020"
output: 
  html_document: 
    toc: yes
    toc_float: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Group Project

## Import Packages

```{r}
library("ggplot2")
library('dplyr')
library('tidyverse')
library('geosphere')
```

## Importing Data

```{r}
# Reading in the sample CSV of rider data we made
rider_2019_sample <- read.csv('sample.csv', stringsAsFactors = TRUE)
head(rider_2019_sample)

# Reading in the weather data set
weather_data <- read.csv('NYCWeather2019.csv', stringsAsFactors = TRUE)
head(weather_data)
```

## Initial Data Summary

```{r}
# Initial summary of rider data set
str(rider_2019_sample)
summary(rider_2019_sample)
```

```{r}
# Initial summart of weather data set
str(weather_data)
summary(rider_2019_sample)
```


## Initial Data Analysis

### Rider Age

```{r}
rider_2019_sample$age <- 2019 - as.numeric(as.character(rider_2019_sample$birth.year))
rider_2019_sample <- filter(rider_2019_sample, age <= 80)
```

### Gender Split in Riders

```{r}
# Reclassifying the genders
# 0=unknown, 1=male, 2=female
rider_2019_sample$gender <- ifelse(rider_2019_sample$gender == 0, "Unkown",
                                  ifelse(rider_2019_sample$gender == 1, "Male", "Female"))

# Seeing the split of genders who rented bikes
gender_split <- ggplot(rider_2019_sample, aes(x=gender)) + geom_bar()
gender_split
```

### Subscriber vs Customer for Riders

```{r}
# Seeing the split of user type who rented bikes
subscriber_split <- ggplot(rider_2019_sample, aes(x=usertype)) + geom_bar()
subscriber_split
```

### Trip Duration

```{r}
# Range of all bike rides
rider_2019_sample <- filter(rider_2019_sample, tripduration <= 3000)
duration_range <- range(rider_2019_sample$tripduration, na.rm=TRUE)
duration_range

# Average length of a bike ride
duration_mean <- mean(rider_2019_sample$tripduration, na.rm=TRUE)
duration_mean

# Standard deviation of bike rides
duration_sd <- sd(rider_2019_sample$tripduration, na.rm=TRUE)
duration_sd
```

### Types of Weather per Month

```{r}
# Creating columns of just month, day, and year
weather_data$DATE <- as.Date(weather_data$DATE, format = "%m/%d/%Y")
weather_data$Month <- format(weather_data$DATE, "%m")
weather_data$Day <- format(weather_data$DATE, "%d")
weather_data$Year <- format(weather_data$DATE, "%Y")
```


```{r}
# Average precipitation per month
percip_per_month <- tapply(weather_data$PRCP, weather_data$Month, mean, na.rm=TRUE)
percip_per_month
```

```{r}
# Average snow per month
snow_per_month <- tapply(weather_data$SNOW, weather_data$Month, mean, na.rm=TRUE)
snow_per_month
```

```{r}
# Average wind speed per month
wind_per_month <- tapply(weather_data$AWND, weather_data$Month, mean, na.rm=TRUE)
wind_per_month
```

## Distance Between Stations

```{r}
# distm(c(rider_2019_sample$start.station.longitude, rider_2019_sample$start.station.latitude),
#       c(rider_2019_sample$end.station.longitude, rider_2019_sample$end.station.latitude),
#       fun = distHaversine)
```

